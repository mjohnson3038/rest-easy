<section>
  <p><%= @receipt %></p>

  <p>Check the items that you ordered</p>

  <p>All guests associated with receipt</p>
  <% @receipt_guests.each do |guest| %>
    <p><%= link_to guest.name, receipt_guest_guest_items_path(receipt_id: guest.receipt_id, guest_id: guest.id), class: "button btn" %></p>
  <% end %>

  <%= form_for @new_guest, :url => { method: :post, action: :create_guest, class:"form", remote: true } do |f|%>

    <div class="form-group">
      <%= f.label :name %>
      <%= f.text_field :name %>
    </div>

    <div class="form-group">
      <%= f.label :phone %>
      <%= f.text_field :phone %>
    </div>

    <%= f.hidden_field :receipt_id, :value => params[:receipt_id] %>
    <%= f.submit "Submit" %>
  <% end %>

  <p>Current User: <%= @current_guest.name %></p>

  <%= form_tag (update_guest_items_path(guest_id: @guest_id)) do %>
    <table class="table-responsive">
      <tr>
        <th>Description</th>
        <th>Price</th>
        <th>Check</th>
      </tr>
      <% @guest_items.each do |item| %>
        <tr class="<%= 'claimed' if item.guest_id != nil %>">
          <td><p><%= ListItem.find(item.list_item_id).description%></p></td>
          <td><%= item.price%></td>

          <!-- The checkbox should be prechecked it the guest_id id == guest.id -->

          <% if item.guest_id != @current_guest.id %>
            <td><%= check_box_tag 'item_ids[]', item.id %></td>
            <%= h item.guest_id -%>
          <% else %>
            <td><%= check_box_tag 'item_ids[]', item.id, true %></td>
            <%= h item.guest_id -%>
          <% end %>

          <!-- TODO maybe make what is visible to the guest different depending on what is available to be checked off -->

        </tr>
      <% end %>
    </table>

    <div class="actions">
      <input type="submit" value="Submit My Orders">
    </div>

    <% end %>

</section>
